<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Blog Name</title>
  <subtitle>Blog subtitle</subtitle>
  <id>http://blog.url.com/</id>
  <link href="http://blog.url.com/"/>
  <link href="http://blog.url.com/feed.xml" rel="self"/>
  <updated>2016-09-26T11:30:00-04:00</updated>
  <author>
    <name>Blog Author</name>
  </author>
  <entry>
    <title>Git Submodule vs. Subtree</title>
    <link rel="alternate" href="http://blog.url.com/2016/09/26/git-submodule-vs-subtree.html"/>
    <id>http://blog.url.com/2016/09/26/git-submodule-vs-subtree.html</id>
    <published>2016-09-26T11:30:00-04:00</published>
    <updated>2016-09-26T16:23:04-04:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;strong&gt;&amp;quot;Shared Repo&amp;quot;&lt;/strong&gt; refers to the code which is shared and will be packaged in a submodule or subtree.
&lt;strong&gt;&amp;quot;Parent Project Repo&amp;quot;&lt;/strong&gt; refers to the project that is going to be including the &lt;em&gt;Shared Repo&lt;/em&gt; as
a submodule or subtree. &lt;/p&gt;

&lt;h2&gt;1. How to Pull Changes from Shared Repo into Parent Project Repo&lt;/h2&gt;

&lt;h3&gt;Submodule&lt;/h3&gt;

&lt;p&gt;You can work in the submodule as if it were its own Git Repo. First you have to go into the submodule
directory:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;cd lib/gitsub-submodule &amp;amp;&amp;amp; git fetch &amp;amp;&amp;amp; git merge origin/master&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; (master)$ git fetch
remote: Counting objects: 3, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 3 (delta 0), reused 3 (delta 0), pack-reused 0
Unpacking objects: 100% (3/3), done.
From github.com:wakproductions/gitsub-submodule
   9dd60f8..e3bedf9  master     -&amp;gt; origin/master
 (master)$ git merge origin/master
Updating 9dd60f8..e3bedf9
Fast-forward
 submodule-library.rb | 4 ++++
 1 file changed, 4 insertions(+)
 (master)$ git log
commit e3bedf9137028aa63dd88ff1e708ce08e921cc99
Author: Winston Kotzan &amp;lt;wak@wakproductions.com&amp;gt;
Date:   Mon Sep 26 15:40:17 2016 -0400

    Add change to shared repo

commit 9dd60f8fc47f089dd5081a0ed73efb7cc923fd9c
Author: Winston Kotzan &amp;lt;wak@wakproductions.com&amp;gt;
Date:   Wed Sep 21 10:25:56 2016 -0400

    First commit - submodule
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You also need to update the parent repo:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; (master)$ git status
On branch master
Changes not staged for commit:
  (use &amp;quot;git add &amp;lt;file&amp;gt;...&amp;quot; to update what will be committed)
  (use &amp;quot;git checkout -- &amp;lt;file&amp;gt;...&amp;quot; to discard changes in working directory)
  (commit or discard the untracked or modified content in submodules)

    modified:   lib/gitsub-submodule (new commits, modified content)

 (master)$ git diff
diff --git a/lib/gitsub-submodule b/lib/gitsub-submodule
index 9dd60f8..e3bedf9 160000
--- a/lib/gitsub-submodule
+++ b/lib/gitsub-submodule
@@ -1 +1 @@
-Subproject commit 9dd60f8fc47f089dd5081a0ed73efb7cc923fd9c
+Subproject commit e3bedf9137028aa63dd88ff1e708ce08e921cc99
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;** Note that the commit reference in the submodule has changed and needs to be committed in the parent repo**&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; (master)$ gc &amp;quot;Update submodule&amp;quot;
On branch master
Changes not staged for commit:
  modified:   lib/gitsub-submodule (new commits)

no changes added to commit

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A disadvantage of using submodules is that your commit history will get dirty with &amp;quot;Update submodule&amp;quot; style commits
in the parent project repo. You won&amp;#39;t have specific information on the version bumps happening within the submodule.&lt;/p&gt;

&lt;h2&gt;2. How to Push Changes from Parent Project Repo to Shared Repo&lt;/h2&gt;

&lt;h2&gt;Submodule Caveats&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;When you clone such a project with submodules, by default you get the directories 
that contain submodules, but none of the files within them yet. (https://git-scm.com/book/en/v2/Git-Tools-Submodules)
To get around this, either do &lt;code&gt;git clone --recursive&lt;/code&gt; or do &lt;code&gt;git submodule init &amp;amp;&amp;amp; git submodule update&lt;/code&gt; after the 
clone.&lt;/li&gt;
&lt;/ul&gt;
</content>
  </entry>
  <entry>
    <title>Configuring Circle-CI for the First Time</title>
    <link rel="alternate" href="http://blog.url.com/2016/09/23/configuring-circle-ci.html.html"/>
    <id>http://blog.url.com/2016/09/23/configuring-circle-ci.html.html</id>
    <published>2016-09-23T11:30:00-04:00</published>
    <updated>2016-09-23T17:12:02-04:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;I&amp;#39;m setting up CI for my employer using Circle-CI. Here are some of the issues I&amp;#39;m running into.&lt;/p&gt;

&lt;p&gt;1. &lt;code&gt;bundle install&lt;/code&gt; fails.&lt;/p&gt;

&lt;p&gt;On the first run, we got the following error message:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bundle check --path=vendor/bundle || bundle install --path=vendor/bundle --jobs=4 --retry=3
ruby-2.3.1 - #gemset created /opt/circleci/.rvm/gems/ruby-2.3.1@banks
ruby-2.3.1 - #generating banks wrappers|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�.|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�.|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�.|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�.|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�.|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�.|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�.|�/�-�\�|�/�-�\�|�.-�\�|�/�-�\�|�/�-�..
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/rubygems/dependency.rb:319:in `to_specs&amp;#39;: Could not find &amp;#39;bundler&amp;#39; (&amp;gt;= 0.a) among 6 total gem(s) (Gem::LoadError)
Checked in &amp;#39;GEM_PATH=/opt/circleci/.rvm/gems/ruby-2.3.1@banks:/opt/circleci/.rvm/gems/ruby-2.3.1@global&amp;#39;, execute `gem env` for more information
    from /opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/rubygems/dependency.rb:328:in `to_spec&amp;#39;
    from /opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb:65:in `gem&amp;#39;
    from /opt/circleci/.rvm/rubies/ruby-2.3.1/bin/bundle:22:in `&amp;lt;main&amp;gt;&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/rubygems/dependency.rb:319:in `to_specs&amp;#39;: Could not find &amp;#39;bundler&amp;#39; (&amp;gt;= 0.a) among 6 total gem(s) (Gem::LoadError)
Checked in &amp;#39;GEM_PATH=/opt/circleci/.rvm/gems/ruby-2.3.1@banks:/opt/circleci/.rvm/gems/ruby-2.3.1@global&amp;#39;, execute `gem env` for more information
    from /opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/rubygems/dependency.rb:328:in `to_spec&amp;#39;
    from /opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/rubygems/core_ext/kernel_gem.rb:65:in `gem&amp;#39;
    from /opt/circleci/.rvm/rubies/ruby-2.3.1/bin/bundle:22:in `&amp;lt;main&amp;gt;&amp;#39;

bundle check --path=vendor/bundle || bundle install --path=vendor/bundle --jobs=4 --retry=3  returned exit code 1

Action failed: bundle install
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The important line is here:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/rubygems/dependency.rb:319:in `to_specs&amp;#39;: Could not find &amp;#39;bundler&amp;#39; (&amp;gt;= 0.a) among 6 total gem(s) (Gem::LoadError)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Unfortunately, CI platforms don&amp;#39;t always run out of the box very well. You need to tell Circle-CI some basic
setup instructions like to first install bundler. So the remedy for this issue was to create a &lt;code&gt;circle.yml&lt;/code&gt; file
in my project root that looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  general:
    branches:
      ignore:
        - /^deploy-.*/ # list of branches to ignore
  dependencies:
    pre:
      - gem install bundler -v 1.13.1
  test:
    override:
      - bundle exec rspec
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note the &lt;code&gt;dependencies&lt;/code&gt; section which runs the command to install bundler first. After this change, bundle install
ran correctly.&lt;/p&gt;

&lt;p&gt;2. Loading of the database schema fails (fail at &lt;code&gt;rake db:create db:schema:load ts:configure ts:index ts:start&lt;/code&gt;)&lt;/p&gt;

&lt;p&gt;So the bundle was fixed. Now I was getting a new error:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;export RAILS_ENV=&amp;quot;test&amp;quot;
export RACK_ENV=&amp;quot;test&amp;quot;
bundle exec rake db:create db:schema:load ts:configure ts:index ts:start --trace
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
in LoadError rescue statement
** Invoke db:create (first_time)
** Invoke db:load_config (first_time)
** Execute db:load_config
** Execute db:create
** Invoke db:schema:load (first_time)
** Invoke environment (first_time)
** Execute environment
DEPRECATION WARNING: The configuration option `config.serve_static_assets` has been renamed to `config.serve_static_files` to clarify its role (it merely enables serving everything in the `public` folder and is unrelated to the asset pipeline). The `serve_static_assets` alias will be removed in Rails 5.0. Please migrate your configuration files accordingly. (called from block in &amp;lt;top (required)&amp;gt; at /home/ubuntu/banks/config/environments/test.rb:16)
DEPRECATION WARNING: Currently, Active Record suppresses errors raised within `after_rollback`/`after_commit` callbacks and only print them to the logs. In the next version, these errors will no longer be suppressed. Instead, the errors will propagate normally just like in other Active Record callbacks.

You can opt into the new behavior and remove this warning by setting:

  config.active_record.raise_in_transactional_callbacks = true

 (called from block in tsort_each at /opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:228)
rake aborted!
ActiveRecord::StatementInvalid: Mysql2::Error: Table &amp;#39;circle_ruby_test.bank_details&amp;#39; doesn&amp;#39;t exist: SHOW FULL FIELDS FROM `bank_details`
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:107:in `_query&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:107:in `block in query&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:106:in `handle_interrupt&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:106:in `query&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:309:in `block in execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_adapter.rb:484:in `block in log&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/notifications/instrumenter.rb:20:in `instrument&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_adapter.rb:478:in `log&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:309:in `execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/mysql2_adapter.rb:231:in `execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:316:in `execute_and_free&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:463:in `columns&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/schema_cache.rb:43:in `columns&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/attributes.rb:93:in `columns&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/model_schema.rb:260:in `column_names&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:232:in `aggregate_column&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:258:in `execute_simple_calculation&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:227:in `perform_calculation&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:133:in `calculate&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:80:in `maximum&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/querying.rb:13:in `maximum&amp;#39;
/home/ubuntu/banks/config/initializers/constants.rb:9:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:268:in `load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:268:in `block in load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:240:in `load_dependency&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:268:in `load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:652:in `block in load_config_initializer&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/notifications.rb:166:in `instrument&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:651:in `load_config_initializer&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:616:in `block (2 levels) in &amp;lt;class:Engine&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:615:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:615:in `block in &amp;lt;class:Engine&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:30:in `instance_exec&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:30:in `run&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:55:in `block in run_initializers&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:422:in `block (2 levels) in each_strongly_connected_component_from&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:421:in `block in each_strongly_connected_component_from&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:44:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:44:in `tsort_each_child&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:415:in `call&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:415:in `each_strongly_connected_component_from&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `call&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:54:in `run_initializers&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/application.rb:352:in `initialize!&amp;#39;
/home/ubuntu/banks/config/environment.rb:5:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:274:in `require&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:274:in `block in require&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:240:in `load_dependency&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:274:in `require&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/application.rb:328:in `require_environment!&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/application.rb:457:in `block in run_tasks_blocks&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:248:in `block in execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:243:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:243:in `execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:187:in `block in invoke_with_call_chain&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:180:in `invoke_with_call_chain&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:209:in `block in invoke_prerequisites&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:207:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:207:in `invoke_prerequisites&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:186:in `block in invoke_with_call_chain&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:180:in `invoke_with_call_chain&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:173:in `invoke&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:152:in `invoke_task&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:108:in `block (2 levels) in top_level&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:108:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:108:in `block in top_level&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:117:in `run_with_threads&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:102:in `top_level&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:80:in `block in run&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:178:in `standard_exception_handling&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:77:in `run&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/exe/rake:27:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/bin/rake:23:in `load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/bin/rake:23:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli/exec.rb:74:in `load&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli/exec.rb:74:in `kernel_load&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli/exec.rb:27:in `run&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli.rb:332:in `exec&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli.rb:20:in `dispatch&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli.rb:11:in `start&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/exe/bundle:34:in `block in &amp;lt;top (required)&amp;gt;&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/friendly_errors.rb:100:in `with_friendly_errors&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/exe/bundle:26:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/bin/bundle:23:in `load&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/bin/bundle:23:in `&amp;lt;main&amp;gt;&amp;#39;
Mysql2::Error: Table &amp;#39;circle_ruby_test.bank_details&amp;#39; doesn&amp;#39;t exist
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:107:in `_query&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:107:in `block in query&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:106:in `handle_interrupt&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/mysql2-0.4.4/lib/mysql2/client.rb:106:in `query&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:309:in `block in execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_adapter.rb:484:in `block in log&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/notifications/instrumenter.rb:20:in `instrument&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_adapter.rb:478:in `log&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:309:in `execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/mysql2_adapter.rb:231:in `execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:316:in `execute_and_free&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:463:in `columns&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/connection_adapters/schema_cache.rb:43:in `columns&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/attributes.rb:93:in `columns&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/model_schema.rb:260:in `column_names&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:232:in `aggregate_column&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:258:in `execute_simple_calculation&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:227:in `perform_calculation&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:133:in `calculate&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/relation/calculations.rb:80:in `maximum&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/querying.rb:13:in `maximum&amp;#39;
/home/ubuntu/banks/config/initializers/constants.rb:9:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:268:in `load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:268:in `block in load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:240:in `load_dependency&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:268:in `load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:652:in `block in load_config_initializer&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/notifications.rb:166:in `instrument&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:651:in `load_config_initializer&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:616:in `block (2 levels) in &amp;lt;class:Engine&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:615:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/engine.rb:615:in `block in &amp;lt;class:Engine&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:30:in `instance_exec&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:30:in `run&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:55:in `block in run_initializers&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:228:in `block in tsort_each&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:350:in `block (2 levels) in each_strongly_connected_component&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:422:in `block (2 levels) in each_strongly_connected_component_from&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:431:in `each_strongly_connected_component_from&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:421:in `block in each_strongly_connected_component_from&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:44:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:44:in `tsort_each_child&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:415:in `call&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:415:in `each_strongly_connected_component_from&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:349:in `block in each_strongly_connected_component&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `call&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:347:in `each_strongly_connected_component&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:226:in `tsort_each&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:205:in `tsort_each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/initializable.rb:54:in `run_initializers&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/application.rb:352:in `initialize!&amp;#39;
/home/ubuntu/banks/config/environment.rb:5:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:274:in `require&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:274:in `block in require&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:240:in `load_dependency&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activesupport-4.2.7/lib/active_support/dependencies.rb:274:in `require&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/application.rb:328:in `require_environment!&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/railties-4.2.7/lib/rails/application.rb:457:in `block in run_tasks_blocks&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:248:in `block in execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:243:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:243:in `execute&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:187:in `block in invoke_with_call_chain&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:180:in `invoke_with_call_chain&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:209:in `block in invoke_prerequisites&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:207:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:207:in `invoke_prerequisites&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:186:in `block in invoke_with_call_chain&amp;#39;
/opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/monitor.rb:214:in `mon_synchronize&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:180:in `invoke_with_call_chain&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/task.rb:173:in `invoke&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:152:in `invoke_task&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:108:in `block (2 levels) in top_level&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:108:in `each&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:108:in `block in top_level&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:117:in `run_with_threads&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:102:in `top_level&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:80:in `block in run&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:178:in `standard_exception_handling&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/lib/rake/application.rb:77:in `run&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rake-11.3.0/exe/rake:27:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/bin/rake:23:in `load&amp;#39;
/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/bin/rake:23:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli/exec.rb:74:in `load&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli/exec.rb:74:in `kernel_load&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli/exec.rb:27:in `run&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli.rb:332:in `exec&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor.rb:359:in `dispatch&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli.rb:20:in `dispatch&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/vendor/thor/lib/thor/base.rb:440:in `start&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/cli.rb:11:in `start&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/exe/bundle:34:in `block in &amp;lt;top (required)&amp;gt;&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/lib/bundler/friendly_errors.rb:100:in `with_friendly_errors&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/gems/bundler-1.13.1/exe/bundle:26:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/bin/bundle:23:in `load&amp;#39;
/opt/circleci/.rvm/gems/ruby-2.3.1@banks/bin/bundle:23:in `&amp;lt;main&amp;gt;&amp;#39;
Tasks: TOP =&amp;gt; db:schema:load =&amp;gt; environment

export RAILS_ENV=&amp;quot;test&amp;quot;
export RACK_ENV=&amp;quot;test&amp;quot;
bundle exec rake db:create db:schema:load ts:configure ts:index ts:start --trace
 returned exit code 1

Action failed: rake db:create db:schema:load ts:configure ts:index ts:start
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now I think this has to do with &lt;code&gt;schema.rb&lt;/code&gt; not working. When I first set up this project, I had to do a
MySQL load of the database schema from the production system in order to get my local dev environment working.
Trying to avoid going too far into a rabbit hole, I tried switching the load process from &lt;code&gt;schema.rb&lt;/code&gt; to 
&lt;code&gt;structure.sql&lt;/code&gt; by adding the following line to our application&amp;#39;s config file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;config.active_record.schema_format = :sql
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I then ran &lt;code&gt;rake db:structure:dump&lt;/code&gt; and checked the changes into source control. This resolved the database
setup issue in Circle-CI. The CI server was smart enough to know based on the &lt;code&gt;application.rb&lt;/code&gt; setting, to
use &lt;code&gt;rake db:structure:load&lt;/code&gt; in its initialization process.&lt;/p&gt;

&lt;p&gt;3. Schema migrations were not populated&lt;/p&gt;

&lt;p&gt;I ran into one final issue.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bundle exec rspec
DEPRECATION WARNING: The configuration option `config.serve_static_assets` has been renamed to `config.serve_static_files` to clarify its role (it merely enables serving everything in the `public` folder and is unrelated to the asset pipeline). The `serve_static_assets` alias will be removed in Rails 5.0. Please migrate your configuration files accordingly. (called from block in &amp;lt;top (required)&amp;gt; at /home/ubuntu/banks/config/environments/test.rb:16)
DEPRECATION WARNING: Currently, Active Record suppresses errors raised within `after_rollback`/`after_commit` callbacks and only print them to the logs. In the next version, these errors will no longer be suppressed. Instead, the errors will propagate normally just like in other Active Record callbacks.

You can opt into the new behavior and remove this warning by setting:

  config.active_record.raise_in_transactional_callbacks = true

 (called from block in tsort_each at /opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:228)
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
[DEPRECATION] `last_comment` is deprecated.  Please use `last_description` instead.
in LoadError rescue statement
DEPRECATION WARNING: The configuration option `config.serve_static_assets` has been renamed to `config.serve_static_files` to clarify its role (it merely enables serving everything in the `public` folder and is unrelated to the asset pipeline). The `serve_static_assets` alias will be removed in Rails 5.0. Please migrate your configuration files accordingly. (called from block in &amp;lt;top (required)&amp;gt; at /home/ubuntu/banks/config/environments/test.rb:16)
DEPRECATION WARNING: Currently, Active Record suppresses errors raised within `after_rollback`/`after_commit` callbacks and only print them to the logs. In the next version, these errors will no longer be suppressed. Instead, the errors will propagate normally just like in other Active Record callbacks.

You can opt into the new behavior and remove this warning by setting:

  config.active_record.raise_in_transactional_callbacks = true

 (called from block in tsort_each at /opt/circleci/ruby/ruby-2.3.1/lib/ruby/2.3.0/tsort.rb:228)
bundler: failed to load command: rspec (/home/ubuntu/banks/vendor/bundle/ruby/2.3.0/bin/rspec)
ActiveRecord::PendingMigrationError: 

Migrations are pending. To resolve this issue, run:

    bin/rake db:migrate RAILS_ENV=test


  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/migration.rb:392:in `check_pending!&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/migration.rb:405:in `load_schema_if_pending!&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/migration.rb:411:in `block in maintain_test_schema!&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/migration.rb:642:in `suppress_messages&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/migration.rb:416:in `method_missing&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/activerecord-4.2.7/lib/active_record/migration.rb:411:in `maintain_test_schema!&amp;#39;
  /home/ubuntu/banks/spec/rails_helper.rb:18:in `&amp;lt;top (required)&amp;gt;&amp;#39;
  /home/ubuntu/banks/spec/controllers/admin/crawl_status_controller_spec.rb:1:in `require&amp;#39;
  /home/ubuntu/banks/spec/controllers/admin/crawl_status_controller_spec.rb:1:in `&amp;lt;top (required)&amp;gt;&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/configuration.rb:1058:in `load&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/configuration.rb:1058:in `block in load_spec_files&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/configuration.rb:1058:in `each&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/configuration.rb:1058:in `load_spec_files&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/runner.rb:97:in `setup&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/runner.rb:85:in `run&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/runner.rb:70:in `run&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/lib/rspec/core/runner.rb:38:in `invoke&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/gems/rspec-core-3.0.4/exe/rspec:4:in `&amp;lt;top (required)&amp;gt;&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/bin/rspec:23:in `load&amp;#39;
  /home/ubuntu/banks/vendor/bundle/ruby/2.3.0/bin/rspec:23:in `&amp;lt;top (required)&amp;gt;&amp;#39;
Coverage report generated for RSpec to /home/ubuntu/banks/coverage. 165 / 710 LOC (23.24%) covered.

bundle exec rspec returned exit code 1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I found out that this was caused by the &lt;code&gt;schema_migrations&lt;/code&gt; table not being populated on my local development 
system. As mentioned above, when I initially set up my local environment, I was given a data dump of the schema 
to get my database up and running. This lacked the migration numbers. I pulled the data from the &lt;code&gt;schema_migrations&lt;/code&gt;
table from another environment, rebuilt &lt;code&gt;structure.sql&lt;/code&gt; using &lt;code&gt;rake db:migrate&lt;/code&gt;, and pushed out the changes.
The test suite ran!   &lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Getting your Ruby on Rails application code into Docker</title>
    <link rel="alternate" href="http://blog.url.com/2016/09/14/getting-your-ruby-on-rails-application-code-into-docker.html"/>
    <id>http://blog.url.com/2016/09/14/getting-your-ruby-on-rails-application-code-into-docker.html</id>
    <published>2016-09-14T17:19:00-04:00</published>
    <updated>2016-09-14T18:43:55-04:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;strong&gt;Objective:&lt;/strong&gt; Get a Rails API app Docker-ready so that it can be run via a Docker container.&lt;/p&gt;

&lt;p&gt;This week I had to build a Rails API microservice that relays custom error messages to Honeybadger. It&amp;#39;s a
self-contained Rails API application, no database, and only one route that accepts inputs, performs some
reformatting, and passes it on to the Honeybadger system. Here is how I got it running in its own Docker container.&lt;/p&gt;

&lt;h4&gt;1. Put a &lt;code&gt;Dockerfile&lt;/code&gt; in the project base directory.&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Pull the Ruby base image from Dockerhub
FROM ruby:2.3.1
RUN apt-get update

# This is where you are going to put your application code,
# transferring it from the project directory into the Docker image
RUN mkdir /app
WORKDIR /app

# Pull all the dependencies from Rubygems
ADD Gemfile /app/Gemfile
ADD Gemfile.lock /app/Gemfile.lock
RUN bundle install

# This line pulls the application code from the project folder and puts it into the Docker image
ADD . /app
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;/Dockerfile&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Docker images are kind of like Virtual Machine images, but not. I think of them more as a lightweight virtual machine
that the Docker team has slimmed down by removing a lot of the bells and whistles that come in a full OS. If you look
at the Dockerfiles of most repositories on Dockerhub, they are all just descendants of a few base systems. For example,
looking at the &lt;a href="https://github.com/docker-library/ruby/blob/2d6449f03976ededa14be5cac1e9e070b74e4de4/2.3/Dockerfile"&gt;Ruby 2.3 Dockerfile&lt;/a&gt;
you will see that it&amp;#39;s built on another Docker image called &lt;a href="https://hub.docker.com/_/buildpack-deps/"&gt;buildpack-deps/jessie&lt;/a&gt;,
which several layers deeper pulls from the &lt;code&gt;debian:jessie&lt;/code&gt; base image. In this project, we are taking the &lt;code&gt;ruby:2.3.1&lt;/code&gt;
prepackaged image from Dockerhub and adding another layer of configuration to it.&lt;/p&gt;

&lt;h4&gt;2. Make a &lt;code&gt;docker-compose.yml&lt;/code&gt; file to more easily run the application.&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;version: &amp;#39;2&amp;#39;
services:
  web:
    build: .
    command: bundle exec rails s -p 3000 -b &amp;#39;0.0.0.0&amp;#39;
    environment:
      - HONEYBADGER_API_KEY=${HONEYBADGER_API_KEY}
    ports:
      - &amp;quot;3000:3000&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;/docker-compose.yml&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;It can take some tedious command line options to run a Docker image the way you want it. To simplify that work there&amp;#39;s
&lt;code&gt;docker-compose&lt;/code&gt;. So in this file I have the configuration for running the application saved so that I don&amp;#39;t have to
specify it every time on the command line. It tells Docker which command to run that will start the Rails server,
maps my ports from the host machine to the container, and set the environment variables.&lt;/p&gt;

&lt;p&gt;Notice that I can pull an environment variable from the host machine by using the &lt;code&gt;${*environment_variable_name*}&lt;/code&gt;
format for the value. This is good practice because I can keep the API key a secret - it won&amp;#39;t accidentally be committed anywhere on Github where
a malicious person can steal it. I can also change the API key on the server without having to modify any code.&lt;/p&gt;

&lt;p&gt;If I had the need for additional dependencies such as a postgres database, I could specify them here in the compose
file.&lt;/p&gt;

&lt;h4&gt;3. Run the application&lt;/h4&gt;

&lt;p&gt;At the command line all you have to do is:
&lt;code&gt;$ docker-compose up -d&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;It will automatically build the image and run the container. The &lt;code&gt;-d&lt;/code&gt; flag has it run in the background so that
I can have the command line back. But if you ran it without the &lt;code&gt;-d&lt;/code&gt; flag, this is what the output should look like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker-compose up
Building web
Step 1 : FROM ruby:2.3.1
 ---&amp;gt; 8576862d3442
Step 2 : RUN apt-get update
 ---&amp;gt; Running in 6602693ad6bc
Get:1 http://security.debian.org jessie/updates InRelease [63.1 kB]
Get:2 http://security.debian.org jessie/updates/main amd64 Packages [389 kB]
Ign http://httpredir.debian.org jessie InRelease
Get:3 http://httpredir.debian.org jessie-updates InRelease [142 kB]
Get:4 http://httpredir.debian.org jessie-updates/main amd64 Packages [17.6 kB]
Get:5 http://httpredir.debian.org jessie Release.gpg [2373 B]
Get:6 http://httpredir.debian.org jessie Release [148 kB]
Get:7 http://httpredir.debian.org jessie/main amd64 Packages [9032 kB]
Fetched 9795 kB in 9s (1079 kB/s)
Reading package lists...
 ---&amp;gt; 1f578850fdb9
Removing intermediate container 6602693ad6bc
Step 3 : RUN mkdir /app
 ---&amp;gt; Running in 61f9bf5d0951
 ---&amp;gt; 4c32b4640e6a
Removing intermediate container 61f9bf5d0951
Step 4 : WORKDIR /app
 ---&amp;gt; Running in bdf44232fda8
 ---&amp;gt; 60c1a7381154
Removing intermediate container bdf44232fda8
Step 5 : ADD Gemfile /app/Gemfile
 ---&amp;gt; 1c6ff0d80fb7
Removing intermediate container 33c8bfdbdafb
Step 6 : ADD Gemfile.lock /app/Gemfile.lock
 ---&amp;gt; aa82e7727c4d
Removing intermediate container c6d328043b8b
Step 7 : RUN bundle install
 ---&amp;gt; Running in e8509116977f
Fetching gem metadata from https://rubygems.org/.........
Fetching version metadata from https://rubygems.org/..
Fetching dependency metadata from https://rubygems.org/.
Installing rake 11.2.2

  &amp;lt;omitted for brevity&amp;gt;

Bundle complete! 9 Gemfile dependencies, 58 gems now installed.
Bundled gems are installed into /usr/local/bundle.
 ---&amp;gt; 2d36ee11a6f5
Removing intermediate container e8509116977f
Step 8 : ADD . /app
 ---&amp;gt; 0d686b7bf04e
Removing intermediate container 5d323b8c0044
Successfully built 0d686b7bf04e
WARNING: Image for service web was built because it did not already exist. To rebuild this image you must use `docker-compose build` or `docker-compose up --build`.
Creating honeybadgernotifier_web_1
Attaching to honeybadgernotifier_web_1
web_1  | =&amp;gt; Booting Puma
web_1  | =&amp;gt; Rails 5.0.0.1 application starting in development on http://0.0.0.0:3000
web_1  | =&amp;gt; Run `rails server -h` for more startup options
web_1  | Puma starting in single mode...
web_1  | * Version 3.6.0 (ruby 2.3.1-p112), codename: Sleepy Sunday Serenity
web_1  | * Min threads: 5, max threads: 5
web_1  | * Environment: development
web_1  | * Listening on tcp://0.0.0.0:3000
web_1  | Use Ctrl-C to stop
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;4. Checking that the tests work&lt;/h4&gt;

&lt;p&gt;I can now console into the running docker container to double check that the test suite passes. First, I open
a bash console with &lt;code&gt;docker exec -i -t honeybadgernotifier_web_1 /bin/bash&lt;/code&gt; and then I can do whatever I want
from inside that docker container as if I was logged onto that machine. So once I&amp;#39;m in I run the &lt;code&gt;rspec&lt;/code&gt; command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker exec -i -t honeybadgernotifier_web_1 /bin/bash
Error response from daemon: Container c860eda8947a817c1743ebac9fa3fa282efca41c3ed31e639a41235e2266a11b is not running
$ rspec

Notification API
  POST /api/v1/notification
DEPRECATION WARNING: ActionDispatch::IntegrationTest HTTP request methods will accept only
the following keyword arguments in future Rails versions:
params, headers, env, xhr, as

Examples:

get &amp;#39;/profile&amp;#39;,
  params: { id: 1 },
  headers: { &amp;#39;X-Extra-Header&amp;#39; =&amp;gt; &amp;#39;123&amp;#39; },
  env: { &amp;#39;action_dispatch.custom&amp;#39; =&amp;gt; &amp;#39;custom&amp;#39; },
  xhr: true,
  as: :json
 (called from api_post at /Users/wkotzan/Development/honeybadger_notifier/spec/helpers/api_helper.rb:7)
    relays the message to Honeybadger

HoneybadgerNotifier::Notify
  forward the data through the Honeybadger API gem
  Honeybadger API key configuration
    should not be nil

Finished in 0.30018 seconds (files took 1.08 seconds to load)
3 examples, 0 failures
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tests are passing!&lt;/p&gt;

&lt;h2&gt;Terminology Tip&lt;/h2&gt;

&lt;p&gt;Don&amp;#39;t forget - A Docker &lt;strong&gt;image&lt;/strong&gt; is like a virtual machine that&amp;#39;s not running. It&amp;#39;s like a computer
hard drive with all the software and configuration in it. A &lt;strong&gt;container&lt;/strong&gt; is a running image. You can have more than
one container running at the same time from the same image.&lt;/p&gt;

&lt;h2&gt;Additional Resources&lt;/h2&gt;

&lt;p&gt;&lt;a href="https://docs.docker.com/compose/rails/"&gt;Docker official: Docker Compose and Rails Quickstart&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href="https://docs.docker.com/engine/reference/commandline/run/#/set-environment-variables-e-env-env-file"&gt;Docker official: setting environment variables&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href="https://robots.thoughtbot.com/rails-on-docker"&gt;Thoughtbot: Rails on Docker&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href="http://stackoverflow.com/questions/30494050/how-to-pass-environment-variables-to-docker-containers"&gt;Stackoverflow: How to pass environment variables to docker containers&lt;/a&gt;&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Feeding Apache log files to Graylog with Docker and apache-mod_log_gelf</title>
    <link rel="alternate" href="http://blog.url.com/2016/09/12/graylog-apache-docker-using-gelf.html"/>
    <id>http://blog.url.com/2016/09/12/graylog-apache-docker-using-gelf.html</id>
    <published>2016-09-12T04:24:00-04:00</published>
    <updated>2016-09-12T18:25:59-04:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;strong&gt;Objective&lt;/strong&gt;: Configure a Graylog server to accept GELF-formatted logs from an Apache web server. Both servers
will be running on Docker, although we will adapt the Apache Docker setup instructions to set up an existing
(non-Docker) Apache server running on Ubuntu 14.04. The logs are going to be sent to the Graylog server using
UDP port 12201.&lt;/p&gt;

&lt;h3&gt;Docker Setup&lt;/h3&gt;

&lt;pre&gt;&lt;code class="yaml"&gt;version: &amp;#39;2&amp;#39;
services:
  apache:
    depends_on:
      - graylog
    image: &amp;quot;wakproductions/apache2-graylog-config&amp;quot;
    volumes:
      - ~/Development/graylog-local/install-demos/apache2/etc/apache2/mods-enabled/log_gelf.conf:/etc/apache2/mods-enabled/log_gelf.conf
    ports:
      - &amp;quot;3000:80&amp;quot;
  mongo:
    image: &amp;quot;mongo:3&amp;quot;
    volumes:
      - ~/Development/graylog-local/data/mongo:/data/db
  elasticsearch:
    image: &amp;quot;elasticsearch:2&amp;quot;
    command: &amp;quot;elasticsearch -Des.cluster.name=&amp;#39;graylog&amp;#39;&amp;quot;
    volumes:
      - ~/Development/graylog-local/data/elasticsearch:/usr/share/elasticsearch/data
  graylog:
    image: &amp;quot;graylog2/server&amp;quot;
    volumes:
      - ~/Development/graylog-local/data/journal:/usr/share/graylog/data/journal
      - ~/Development/graylog-local/config:/usr/share/graylog/data/config
    environment:
      # GRAYLOG_WEB_ENDPOINT_URI: &amp;quot;http://127.0.0.1:9000/api/&amp;quot; # didn&amp;#39;t like having this config here (tried looking for REST server at this address) - could be a bug
      GRAYLOG_REST_TRANSPORT_URI: &amp;quot;http://127.0.0.1:12900&amp;quot;
    depends_on:
      - mongo
      - elasticsearch
    ports:
      - &amp;quot;9000:9000&amp;quot;
      - &amp;quot;12900:12900&amp;quot;
      - &amp;quot;5555:5555&amp;quot;
      - &amp;quot;12201:12201/udp&amp;quot;
      - &amp;quot;12201:12201&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;docker-compose.yml&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;If using a preexisting Apache server, you could remove the &lt;code&gt;apache&lt;/code&gt; block and dependency from the file. You&amp;#39;ll just
have to mirror the image setup instructions below to get the GELF module installed on your Apache server.&lt;/p&gt;

&lt;h3&gt;Apache Docker Image Setup (wakproductions/apache2-graylog-config)&lt;/h3&gt;

&lt;p&gt;For Apache to submit GELF logs to Graylog, there is a community-supported module named &lt;a href="https://github.com/Graylog2/apache-mod_log_gelf"&gt;apache-mod_log_gelf&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;FROM webdevops/apache:ubuntu-14.04

ENV WEB_DOCUMENT_INDEX index.html
ADD app /app

RUN apt-get update &amp;amp;&amp;amp; apt-get upgrade

RUN a2dismod mpm_event
RUN a2enmod mpm_prefork &amp;amp;&amp;amp; apt-get install libjson-c2 zlib1g

RUN wget https://github.com/Graylog2/apache-mod_log_gelf/releases/download/0.2.0/libapache2-mod-gelf_0.2.0-1_amd64.ubuntu.deb
RUN dpkg -i libapache2-mod-gelf_0.2.0-1_amd64.ubuntu.deb
RUN a2enmod log_gelf &amp;amp;&amp;amp; restart apache
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Dockerfile&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GelfEnabled On
GelfUrl &amp;quot;udp://graylog:12201&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;/etc/apache2/mods-enabled/log_gelf.conf&lt;/strong&gt; &lt;a href="https://github.com/Graylog2/apache-mod_log_gelf#configuration"&gt;Reference&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Troubleshooting &lt;code&gt;docker build&lt;/code&gt;&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;ERROR: Module mpm_event is enabled - cannot proceed due to conflicts. It needs to be disabled first!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;I found a clue to fixing this problem &lt;a href="http://askubuntu.com/questions/528866/apache-2-4-cannot-proceed-due-to-conflicts-with-module-mpm-prefork"&gt;here&lt;/a&gt;.
It was resolved by disabling &lt;code&gt;mpm_event&lt;/code&gt; via the command &lt;code&gt;a2dismod mpm_event&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;dpkg: error processing archive libapache2-mod-gelf&lt;em&gt;0.1.0-1&lt;/em&gt;amd64.deb (--install):&lt;/strong&gt;
  &lt;strong&gt;cannot access archive: No such file or directory&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The instructions on the apache-mod_log_gelf page were misleading. I overlooked the part that read: &amp;quot;Download a package
for your operating system from &lt;a href="https://github.com/Graylog2/apache-mod_log_gelf/releases"&gt;here&lt;/a&gt; Update Apache2 to the
latests version and use mpm_prefork.&amp;quot;&lt;/p&gt;

&lt;p&gt;To fix the error you have to follow that link and download the latest version of module into the working directory on
the Apache server. So I added the following line:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;RUN wget https://github.com/Graylog2/apache-mod_log_gelf/releases/download/0.2.0/libapache2-mod-gelf_0.2.0-1_amd64.ubuntu.deb&lt;/code&gt;&lt;/p&gt;

&lt;h3&gt;Docker Networking Gotcha&lt;/h3&gt;

&lt;h4&gt;Getting the Apache server to see the Graylog server&lt;/h4&gt;

&lt;p&gt;It took me a while to figure out how to get the Apache server to talk to the Graylog server. Initially, I set the
&lt;code&gt;GelfUrl &amp;quot;udp:127.0.0.1:12201&amp;quot;&lt;/code&gt; but the Graylog server was not receiving anything. The problem was that this was the
equivalent to the Apache server trying to connect to itself on UDP 12201. You have to use the bridge network IP
address of the Graylog server, or refer to it by the network hostname assigned by the Docker network. Each
container has a hostname respective to the name you assign it in the &lt;code&gt;docker-compose.yml&lt;/code&gt; file.&lt;/p&gt;

&lt;h3&gt;Useful Terminal Commands&lt;/h3&gt;

&lt;p&gt;Build Apache server image:
&lt;code&gt;docker build -t wakproductions/apache2-graylog-config .&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Send test message on port 5555 to Graylog (non-GELF) from Apache docker server
&lt;code&gt;echo &amp;quot;hello from apache&amp;quot; | nc -vz graylog 5555&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Send GELF test message on port 12201 to Graylog from Apache docker server
echo -e &amp;#39;{&amp;quot;version&amp;quot;: &amp;quot;1.1&amp;quot;,&amp;quot;host&amp;quot;:&amp;quot;example.org&amp;quot;,&amp;quot;short&lt;em&gt;message&amp;quot;:&amp;quot;Short message&amp;quot;,&amp;quot;full&lt;/em&gt;message&amp;quot;:&amp;quot;Backtrace here\n\nmore stuff&amp;quot;,&amp;quot;level&amp;quot;:1,&amp;quot;&lt;em&gt;user&lt;/em&gt;id&amp;quot;:9001,&amp;quot;&lt;em&gt;some&lt;/em&gt;info&amp;quot;:&amp;quot;foo&amp;quot;,&amp;quot;&lt;em&gt;some&lt;/em&gt;env_var&amp;quot;:&amp;quot;bar&amp;quot;}\0&amp;#39; | nc -u graylog 12201&lt;/p&gt;

&lt;h3&gt;Sample Graylog Configuration&lt;/h3&gt;

&lt;div class="image-box"&gt;
  &lt;div class="image-box-content"&gt;
    &lt;a href="../../../images/2016/Pasted_Image_9_12_16__8_18_AM.png"&gt;&lt;img src="../../../images/2016/Pasted_Image_9_12_16__8_18_AM.png" alt="Pasted image 9 12 16  8 18 am" /&gt;&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry>
    <title>Github Organization and Project Pages under a single domain with Middleman</title>
    <link rel="alternate" href="http://blog.url.com/2016/09/11/github-pages-organization-page-domain-name-on-middleman.html"/>
    <id>http://blog.url.com/2016/09/11/github-pages-organization-page-domain-name-on-middleman.html</id>
    <published>2016-09-11T15:50:00-04:00</published>
    <updated>2016-09-12T18:21:10-04:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;I have my primary website &lt;a href="http://www.winstonkotzan.com/"&gt;winstonkotzan.com&lt;/a&gt; set up as a Github Pages organization
page. The repo is &lt;a href="https://github.com/wakproductions/wakproductions.github.io"&gt;wakproductions.github.io&lt;/a&gt;. However,
to start this blog I decided to create a new Middleman repo to keep all the code separate from my base website
and give me more flexibility between managing the blog component and my other content. So I created a new
repo called &lt;a href="https://github.com/wakproductions/blog"&gt;blog&lt;/a&gt; which would host all the content in the folder
&lt;a href="http://www.winstonkotzan.com/blog"&gt;winstonkotzan.com/blog&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;So Github pages have two different flavors. It&amp;#39;s got &lt;em&gt;organization&lt;/em&gt; pages and &lt;em&gt;project&lt;/em&gt; pages. The &lt;em&gt;organization&lt;/em&gt;
page goes to your root at &lt;em&gt;myusername.github.io&lt;/em&gt; while project pages show up at &lt;em&gt;myusername.github.io/project&lt;/em&gt;name&lt;em&gt;.
So basically my domain name winstonkotzan.com points to my _organization&lt;/em&gt; page and my blog is just a statically
generated &lt;em&gt;project&lt;/em&gt; page with the project name &amp;quot;blog&amp;quot;. One of the things I always found weird about how to upload
your static HTML pages is that the &lt;em&gt;organization&lt;/em&gt; page requires the static public web pages to be in the &lt;em&gt;master&lt;/em&gt;
github branch, but the &lt;em&gt;project&lt;/em&gt; pages require the static public web pages to be in a branch named &lt;em&gt;gh-pages&lt;/em&gt;.
It&amp;#39;s weird becuase for my &lt;em&gt;organization&lt;/em&gt; page I have to put all the source code in a branch called &lt;em&gt;source&lt;/em&gt;, whereas
most other repositories use &lt;em&gt;master&lt;/em&gt; for the main branch of source code. You can read the full docs on the 
differences between organization and project pages 
&lt;a href="https://help.github.com/articles/user-organization-and-project-pages/"&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Upon the first upload of my blog, I had this problem with the blog pages using the wrong style sheet. This is how my
website looked:&lt;/p&gt;

&lt;p&gt;&lt;img src="../../../images/2016/Screen_Shot_2016-09-11_at_3.01.42_PM.png" style="width: 700px" relative="true" alt="Screen shot 2016 09 11 at 3.01.42 pm" /&gt;&lt;/p&gt;

&lt;p&gt;I was able to fix the problem by using the relative links identifiers in the page template.&lt;/p&gt;

&lt;p&gt;&lt;img src="../../../images/2016/Pasted_Image_9_11_16__3_18_PM.png" style="width: 700px" relative="true" alt="Pasted image 9 11 16  3 18 pm" /&gt;&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Receiving 'error: src refspec gh-pages does not match any' on first publish with Middleman/middleman-gh-pages</title>
    <link rel="alternate" href="http://blog.url.com/2016/09/11/middleman-middleman-gh-pages-first-publish-error-src-refspec-gh-pages-does-not-match-any.html"/>
    <id>http://blog.url.com/2016/09/11/middleman-middleman-gh-pages-first-publish-error-src-refspec-gh-pages-does-not-match-any.html</id>
    <published>2016-09-11T01:59:00-04:00</published>
    <updated>2016-09-11T14:59:44-04:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;ol&gt;
&lt;li&gt;Created blank repository for new blog website using Middleman, Github Pages, and the &lt;code&gt;middleman-gh-pages&lt;/code&gt; gem.&lt;/li&gt;
&lt;li&gt;Tried to upload my blog for the first time using the following sequence of commands and received the following error:&lt;/li&gt;
&lt;/ol&gt;

&lt;pre&gt;&lt;code&gt; (master)$ git init
 (master)$ git add . 
 (master)$ git commit -m &amp;quot;Initial commit; first blog post&amp;quot; 
 (master)$ remote add origin git@github.com:wakproductions/blog.git 
 (master)$ rake publish  
cd /Users/wkotzan/Development/wakproductions-tech-blog
cd -
cd /Users/wkotzan/Development/wakproductions-tech-blog/build
git init
Initialized empty Git repository in /Users/wkotzan/Development/wakproductions-tech-blog/build/.git/
git remote add origin git@github.com:wakproductions/blog.git
git fetch --depth 1 origin gh-pages
fatal: Couldn&amp;#39;t find remote ref gh-pages
rake aborted!
Command failed with status (128): [git fetch --depth 1 origin gh-pages...]
/Users/wkotzan/.rvm/gems/ruby-2.3.0/gems/middleman-gh-pages-0.3.0/lib/middleman-gh-pages/tasks/gh-pages.rake:42:in `block (2 levels) in &amp;lt;top (required)&amp;gt;&amp;#39;
/Users/wkotzan/.rvm/gems/ruby-2.3.0/gems/middleman-gh-pages-0.3.0/lib/middleman-gh-pages/tasks/gh-pages.rake:39:in `block in &amp;lt;top (required)&amp;gt;&amp;#39;
/Users/wkotzan/.rvm/gems/ruby-2.3.0/gems/rake-11.2.2/exe/rake:27:in `&amp;lt;top (required)&amp;gt;&amp;#39;
/Users/wkotzan/.rvm/gems/ruby-2.3.0/bin/ruby_executable_hooks:15:in `eval&amp;#39;
/Users/wkotzan/.rvm/gems/ruby-2.3.0/bin/ruby_executable_hooks:15:in `&amp;lt;main&amp;gt;&amp;#39;
Tasks: TOP =&amp;gt; publish =&amp;gt; sync_build_dir =&amp;gt; prepare_build_dir =&amp;gt; /Users/wkotzan/Development/wakproductions-tech-blog/build/.git/refs/remotes/origin/gh-pages
(See full trace by running task with --trace) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This error occurs because you need to have the gh-pages branch existing already. Fixed the error by creating the branch:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; (master)$ git checkout -b gh-pages
Switched to a new branch &amp;#39;gh-pages&amp;#39;
 (gh-pages)$ git checkout master
Switched to branch &amp;#39;master&amp;#39;
 (master)$ rake publish

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The publish operation then worked.&lt;/p&gt;
</content>
  </entry>
</feed>
