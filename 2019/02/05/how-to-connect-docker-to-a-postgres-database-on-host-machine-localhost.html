<!DOCTYPE html>
<html>
  <head>
    <meta content='IE=edge' http-equiv='X-UA-Compatible'>
    <meta charset='utf-8'>
    <meta content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no' name='viewport'>
    <!-- For Facebook link formatting -->
    <meta content='http://www.winstonkotzan.com/2019/02/05/how-to-connect-docker-to-a-postgres-database-on-host-machine-localhost.html' property='og:url'>
    <meta content='article' property='og:type'>
    <meta content='How to connect a Docker application to a Postgres database on the host machine' property='og:title'>
    <meta content='Connecting a Docker application to non-Dockerized Postgres database from is a more complicated task than you would think.' property='og:description'>
    <meta content='http://www.winstonkotzan.com/blog/images/blog-default-social-media-image.jpg' property='og:image'>
    <meta content='Connecting a Docker application to non-Dockerized Postgres database from is a more complicated task than you would think.' name='twitter:card'>
    <title>How to connect a Docker application to a Postgres database on the host machine</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <link href="../../../stylesheets/site.css" rel="stylesheet" />
    <script src="../../../javascripts/all.js"></script>
    <script src="../../../javascripts/jquery-2.2.3.min.js"></script>
    
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-46648633-1', 'winstonkotzan.com');
        ga('send', 'pageview');
    </script>
  </head>
  <body class='x2019 x2019_02 x2019_02_05 x2019_02_05_how-to-connect-docker-to-a-postgres-database-on-host-machine-localhost'>
    <div class='jumbotron'>
      <div class='container'>
        <div class='col-lg-offset-6 col-lg-6 blog-title-box'>
          <div class='content'>
            <a href="/blog/">Winston Kotzan's Technology Blog</a>
          </div>
        </div>
      </div>
    </div>
    <div class='container content'>
      <div class='col-md-8'>
        <div class='main article-content' role='main'>
          <h2 class='article-title'>How to connect a Docker application to a Postgres database on the host machine</h2>
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- article-top -->
          <ins class="adsbygoogle"
               style="display:inline-block;width:728px;height:90px"
               data-ad-client="ca-pub-9623179230776920"
               data-ad-slot="7383597095"></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
          <div class='article-date'>02/05/2019</div>
          <div class='article-body'>
            <p>Connecting a Docker application to non-Dockerized Postgres database from is a more complicated task
            than you would think. While a Docker container can easily communicate with other containers running on the same machine,
            it can&#39;t easily find how to connect to the host machine running it. This is because of the way Docker handles 
            networking, by isolating the containers on its own virtual network which doesn&#39;t include the computer hosting Docker.</p>
            
            <p>A while back I published <a href="2017-06-01-connecting-to-external-postgres-database-with-docker.html.markdown">How to connect to an external Postgres database from a Docker container</a>,
            which showed you how to tinker with the settings on your local machine or any other computer in your local network
            so that your Dockerized app can connect to Postgres. I&#39;ve recently discovered an alternative method which is even faster.
            Here&#39;s how I do it now: </p>
            
            <pre><code class="yaml">version: &#39;3&#39;&#x000A;&#x000A;services:&#x000A;  myapp:&#x000A;    build: .&#x000A;    command: &quot;bundle exec rails s&quot;&#x000A;    environment:&#x000A;      - DATABASE_URL=${DATABASE_URL} # Connection string to the database goes here&#x000A;      - PGPASSWORD=${PGPASSWORD}&#x000A;      - RAILS_ENV=${RAILS_ENV:-development}&#x000A;      - RAILS_LOG_TO_STDOUT=true&#x000A;    network_mode: host&#x000A;    tty: true&#x000A;</code></pre>
            
            <p>Notice how in my <code>docker-compose</code> the <code>network_mode</code> is &quot;host&quot;. This value will cause the container to run from the
            host&#39;s network directly - no isolation of the container onto its own network. That means <code>localhost</code> in the container
            will point to the <code>localhost</code> of your machine. You can then connect to Postgres in the command line from within
            the container like this:</p>
            
            <pre><code>$ docker-compose run myapp /bin/sh&#x000A;&#x000A;/app # psql -U postgres -h localhost&#x000A;psql (10.5, server 9.6.11)&#x000A;Type &quot;help&quot; for help.&#x000A;&#x000A;postgres=# &#x000A;&#x000A;</code></pre>
            
            <p>Note that it&#39;s necessary to specify the <code>-h localhost</code> parameter. Also, if you make use of the <code>PGPASSWORD</code> environment
            variable you can have that set to the database password so that it won&#39;t prompt you to type it in.</p>
          </div>
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- article-bottom -->
          <ins class="adsbygoogle"
               style="display:inline-block;width:336px;height:280px"
               data-ad-client="ca-pub-9623179230776920"
               data-ad-slot="8860330295"></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
          <div id="disqus_thread"></div>
          <script>
          
            /**
             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
            /*
             var disqus_config = function () {
             this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
             this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
             };
             */
            (function() { // DON'T EDIT BELOW THIS LINE
              var d = document, s = d.createElement('script');
              s.src = 'https://winstonkotzan.disqus.com/embed.js';
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
            })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>
      <div class='col-md-4'>
        <aside>
          <h2>Recent Articles</h2>
          <ol>
            <li><a href="../../04/10/how-to-use-a-regular-js-component-with-vue.html">How to Use Standard Javascript Components with Vue.js</a> <span>Apr 10</span></li>
            <li><a href="../../04/09/the-easy-guide-to-making-your-github-pages-site-https.html">The Easy Guide to Making Your Github Pages Site HTTPS</a> <span>Apr  9</span></li>
            <li><a href="../../04/03/docker-volumes-dont-make-this-mistake.html">Don't Make This Mistake When Using Docker Volumes!</a> <span>Apr  3</span></li>
            <li><a href="../../03/21/make-blog-posts-shareable-with-opengraph-meta-tags.html">Make Your Blog Posts Shareable with OpenGraph Meta Tags</a> <span>Mar 21</span></li>
            <li><a href="../../03/09/production-https-setup-for-ruby-on-rails-app-with-docker.html">How to Set Up HTTPS for Free on a Dockerized Ruby on Rails Production Server</a> <span>Mar  9</span></li>
            <li><a href="how-to-connect-docker-to-a-postgres-database-on-host-machine-localhost.html">How to connect a Docker application to a Postgres database on the host machine</a> <span>Feb  5</span></li>
            <li><a href="../04/three-allergic-triggers-that-can-cause-eczema.html">Three Allergic Triggers That Can Cause Eczema</a> <span>Feb  4</span></li>
            <li><a href="../03/i-conquered-eczema-after-30-years-of-itchy-skin-and-you-can-too.html">I Conquered Eczema after 30 Years of Itchy Skin, And You Can Too</a> <span>Feb  3</span></li>
            <li><a href="../../../2018/03/05/how-to-install-node-on-ruby-5-debian-stretch-docker-container.html">How to Node on Ruby 2.5.0 (Debian Stretch) Docker Container</a> <span>Mar  5</span></li>
            <li><a href="../../../2018/01/30/how-to-install-twitter-bootstrap-into-webpack-react-application.html">How to Install Twitter Bootstrap into a Webpack/React.js Application</a> <span>Jan 30</span></li>
          </ol>
          <h2>By Year</h2>
          <ol>
            <li><a href="../../../2019.html">2019 (8)</a></li>
            <li><a href="../../../2018.html">2018 (4)</a></li>
            <li><a href="../../../2017.html">2017 (20)</a></li>
            <li><a href="../../../2016.html">2016 (7)</a></li>
          </ol>
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- Sidebar ad -->
          <ins class="adsbygoogle"
               style="display:inline-block;width:300px;height:600px"
               data-ad-client="ca-pub-9623179230776920"
               data-ad-slot="2953397495"></ins>
          <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </aside>
      </div>
    </div>
  </body>
</html>
